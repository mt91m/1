<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¬Ø²ÙˆØ§Øª Ø¯Ø±Ø³ÛŒ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap');
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Vazirmatn', sans-serif;
        }
        
        body {
            direction: rtl;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        header {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .login-section {
            padding: 40px;
            text-align: center;
            background: #e3f2fd;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 0;
            min-height: 600px;
        }
        
        .sidebar {
            background: #34495e;
            color: white;
            padding: 25px;
        }
        
        .content-area {
            padding: 30px;
            background: #f8f9fa;
        }
        
        .hidden {
            display: none;
        }
        
        input, button, select {
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            width: 100%;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .file-item {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .category-item {
            padding: 15px;
            margin: 8px 0;
            background: #4a6572;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .category-item:hover {
            background: #556f7c;
        }
        
        .category-item.active {
            background: #3498db;
        }
        
        .file-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }
        
        .admin-only {
            background: #e74c3c;
        }
        
        .admin-only:hover {
            background: #c0392b;
        }
        
        .upload-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px dashed #bdc3c7;
        }
        
        .user-badge {
            background: #27ae60;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“š Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ø¬Ø²ÙˆØ§Øª Ø¯Ø±Ø³ÛŒ</h1>
            <p>Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¬Ø²ÙˆØ§Øª Ø¢Ù…ÙˆØ²Ø´ÛŒ</p>
        </header>
        
        <!-- Ø¨Ø®Ø´ ÙˆØ±ÙˆØ¯ -->
        <div class="login-section" id="loginSection">
            <h2>ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…</h2>
            <input type="text" id="username" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ">
            <input type="password" id="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
            <button onclick="login()">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…</button>
            <div style="margin-top: 20px; color: #666;">
                <p>ğŸ‘¨â€ğŸ« Ù…Ø¯ÛŒØ±Ø§Ù†: Ù…Ù‡Ø¯ÛŒØ§Ø± Ø·Ø§ÛŒÙÛŒ (mio91fox) | Ø¯ÙˆØ³ØªØ§Ù†Ù‡ (dostane)</p>
                <p>ğŸ‘ï¸ Ù†Ù…Ø§ÛŒØ´Ú¯Ø±: Ø¨ÛŒÙ†Ù†Ø¯Ù‡ (1111)</p>
            </div>
        </div>
        
        <!-- Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§ØµÙ„ÛŒ -->
        <div class="main-content hidden" id="mainApp">
            <!-- Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± -->
            <div class="sidebar">
                <h3>ğŸ“ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</h3>
                
                <!-- Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ† -->
                <div id="adminControls" class="hidden">
                    <input type="text" id="newCategory" placeholder="Ù†Ø§Ù… Ø¯Ø³ØªÙ‡ Ø¬Ø¯ÛŒØ¯">
                    <button onclick="addCategory()">â• Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡</button>
                    <hr style="margin: 20px 0; border-color: #4a6572;">
                </div>

                <!-- Ù„ÛŒØ³Øª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ -->
                <div id="categoriesList">
                    <div class="category-item active" onclick="selectCategory('all')">
                        ğŸ“‚ Ù‡Ù…Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§
                    </div>
                </div>
            </div>
            
            <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
            <div class="content-area">
                <!-- Ø¨Ø®Ø´ Ø¢Ù¾Ù„ÙˆØ¯ (ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†) -->
                <div id="uploadSection" class="hidden">
                    <div class="upload-section">
                        <h3>ğŸ“¤ Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯</h3>
                        <input type="file" id="fileInput">
                        <input type="text" id="fileName" placeholder="Ù†Ø§Ù… Ù†Ù…Ø§ÛŒØ´ÛŒ ÙØ§ÛŒÙ„ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
                        <select id="fileCategory">
                            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</option>
                        </select>
                        <button onclick="uploadFile()">Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„</button>
                    </div>
                </div>
                
                <!-- Ù†Ù…Ø§ÛŒØ´ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ -->
                <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>
                            ğŸ“‚ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ 
                            <span id="currentCategory" style="color: #3498db;"></span>
                        </h3>
                        <div>
                            <span id="userRoleBadge" class="user-badge"></span>
                            <button onclick="logout()" style="width: auto; background: #e74c3c;">ğŸšª Ø®Ø±ÙˆØ¬</button>
                        </div>
                    </div>
                    
                    <div id="filesList">
                        <div style="text-align: center; color: #7f8c8d; padding: 60px 20px;">
                            <div style="font-size: 60px; margin-bottom: 20px;">ğŸ“­</div>
                            <h3>Ù‡Ù†ÙˆØ² ÙØ§ÛŒÙ„ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</h3>
                            <p>Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…Ø¬Ø§Ø²
        const users = {
            'Ù…Ù‡Ø¯ÛŒØ§Ø± Ø·Ø§ÛŒÙÛŒ': { password: 'mio91fox', role: 'admin' },
            'Ø¨ÛŒÙ†Ù†Ø¯Ù‡': { password: '1111', role: 'viewer' },
            'Ø¯ÙˆØ³ØªØ§Ù†Ù‡': { password: 'dostane', role: 'admin' }
        };

        let currentUser = null;
        let currentCategory = 'all';
        let files = [];
        let categories = ['Ø¹Ù„ÙˆÙ…', 'Ù‡Ù†Ø¯Ø³Ù‡', 'ØªÙÚ©Ø±', 'Ø±ÛŒØ§Ø¶ÛŒ', 'Ø§Ø¯Ø¨ÛŒØ§Øª'];

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² localStorage
        function loadData() {
            try {
                const savedFiles = localStorage.getItem('sharedFiles');
                const savedCategories = localStorage.getItem('fileCategories');
                
                if (savedFiles) files = JSON.parse(savedFiles);
                if (savedCategories) categories = JSON.parse(savedCategories);
            } catch (e) {
                console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§');
                files = [];
            }
        }

        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± localStorage
        function saveData() {
            try {
                localStorage.setItem('sharedFiles', JSON.stringify(files));
                localStorage.setItem('fileCategories', JSON.stringify(categories));
            } catch (e) {
                console.log('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§');
            }
        }

        // Ù†Ù…Ø§ÛŒØ´ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§
        function showFiles() {
            const filesList = document.getElementById('filesList');
            const filteredFiles = currentCategory === 'all' 
                ? files 
                : files.filter(file => file.category === currentCategory);
            
            if (filteredFiles.length === 0) {
                filesList.innerHTML = `
                    <div style="text-align: center; color: #7f8c8d; padding: 60px 20px;">
                        <div style="font-size: 60px; margin-bottom: 20px;">ğŸ“­</div>
                        <h3>ÙØ§ÛŒÙ„ÛŒ Ø¯Ø± Ø§ÛŒÙ† Ø¯Ø³ØªÙ‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</h3>
                        <p>ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯</p>
                    </div>
                `;
                return;
            }

            filesList.innerHTML = filteredFiles.map(file => `
                <div class="file-item">
                    <strong>ğŸ“„ ${file.name}</strong>
                    <div style="margin: 10px 0; color: #666;">
                        <small>
                            ğŸ·ï¸ Ø¯Ø³ØªÙ‡: ${file.category} | 
                            ğŸ“ Ø³Ø§ÛŒØ²: ${file.size} | 
                            ğŸ“… ØªØ§Ø±ÛŒØ®: ${file.date}
                        </small>
                    </div>
                    <div class="file-actions">
                        <button onclick="downloadFile('${file.id}')">â¬‡ï¸ Ø¯Ø§Ù†Ù„ÙˆØ¯</button>
                        <button onclick="viewFile('${file.id}')">ğŸ‘ï¸ Ù…Ø´Ø§Ù‡Ø¯Ù‡</button>
                        ${currentUser?.role === 'admin' ? 
                            `<button class="admin-only" onclick="deleteFile('${file.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§
        function showCategories() {
            const categoriesList = document.getElementById('categoriesList');
            const categorySelect = document.getElementById('fileCategory');
            
            categoriesList.innerHTML = `
                <div class="category-item ${currentCategory === 'all' ? 'active' : ''}" 
                     onclick="selectCategory('all')">ğŸ“‚ Ù‡Ù…Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§</div>
            `;
            
            categorySelect.innerHTML = '<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</option>';
            
            categories.forEach(cat => {
                categoriesList.innerHTML += `
                    <div class="category-item ${currentCategory === cat ? 'active' : ''}" 
                         onclick="selectCategory('${cat}')">ğŸ“ ${cat}</div>
                `;
                categorySelect.innerHTML += `<option value="${cat}">${cat}</option>`;
            });
        }

        // Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
        function selectCategory(category) {
            currentCategory = category;
            document.getElementById('currentCategory').textContent = 
                category === 'all' ? '' : `- ${category}`;
            showCategories();
            showFiles();
        }

        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
        function addCategory() {
            if (currentUser?.role !== 'admin') return;
            
            const newCat = document.getElementById('newCategory').value.trim();
            if (newCat && !categories.includes(newCat)) {
                categories.push(newCat);
                saveData();
                showCategories();
                document.getElementById('newCategory').value = '';
                alert(`Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ "${newCat}" Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯`);
            }
        }

        // ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (users[username] && users[username].password === password) {
                currentUser = { username, role: users[username].role };
                
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                
                // Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§
                if (currentUser.role === 'viewer') {
                    document.getElementById('uploadSection').style.display = 'none';
                    document.getElementById('adminControls').style.display = 'none';
                } else {
                    document.getElementById('uploadSection').style.display = 'block';
                    document.getElementById('adminControls').style.display = 'block';
                }
                
                document.getElementById('userRoleBadge').textContent = 
                    currentUser.role === 'admin' ? 'ğŸ‘‘ Ù…Ø¯ÛŒØ±' : 'ğŸ‘ï¸ Ù†Ù…Ø§ÛŒØ´Ú¯Ø±';
                
                loadData();
                showCategories();
                showFiles();
                
            } else {
                alert('Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª');
            }
        }

        // Ø®Ø±ÙˆØ¬
        function logout() {
            currentUser = null;
            document.getElementById('loginSection').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        // Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„
        function uploadFile() {
            if (currentUser?.role !== 'admin') {
                alert('Ø´Ù…Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ Ù†Ø¯Ø§Ø±ÛŒØ¯');
                return;
            }

            const fileInput = document.getElementById('fileInput');
            const fileName = document.getElementById('fileName').value || fileInput.files[0]?.name || 'ÙØ§ÛŒÙ„ Ø¨Ø¯ÙˆÙ† Ù†Ø§Ù…';
            const category = document.getElementById('fileCategory').value || categories[0];

            if (!fileInput.files[0]) {
                alert('Ù„Ø·ÙØ§ ÛŒÚ© ÙØ§ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                return;
            }

            const file = fileInput.files[0];
            
            // ØªØ¨Ø¯ÛŒÙ„ ÙØ§ÛŒÙ„ Ø¨Ù‡ Base64
            const reader = new FileReader();
            reader.onload = function(e) {
                const fileData = {
                    id: Date.now().toString(),
                    name: fileName,
                    originalName: file.name,
                    size: formatFileSize(file.size),
                    type: file.type,
                    category: category,
                    date: new Date().toLocaleDateString('fa-IR'),
                    data: e.target.result, // Ø¯Ø§Ø¯Ù‡ Base64
                    isBase64: true
                };

                files.push(fileData);
                saveData();
                
                // Ø±ÛŒØ³Øª ÙØ±Ù…
                fileInput.value = '';
                document.getElementById('fileName').value = '';
                
                showFiles();
                alert('âœ… ÙØ§ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯!');
            };
            reader.readAsDataURL(file);
        }

        // Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„
        function downloadFile(fileId) {
            const file = files.find(f => f.id === fileId);
            if (file && file.data) {
                const link = document.createElement('a');
                link.href = file.data;
                link.download = file.originalName || file.name;
                link.click();
            }
        }

        // Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙØ§ÛŒÙ„
        function viewFile(fileId) {
            const file = files.find(f => f.id === fileId);
            if (file && file.data) {
                window.open(file.data, '_blank');
            }
        }

        // Ø­Ø°Ù ÙØ§ÛŒÙ„
        function deleteFile(fileId) {
            if (currentUser?.role !== 'admin') {
                alert('Ø´Ù…Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø­Ø°Ù ÙØ§ÛŒÙ„ Ù†Ø¯Ø§Ø±ÛŒØ¯');
                return;
            }

            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ØŸ')) {
                files = files.filter(file => file.id !== fileId);
                saveData();
                showFiles();
            }
        }

        // ÙØ±Ù…Øª Ø³Ø§ÛŒØ² ÙØ§ÛŒÙ„
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        loadData();
    </script>
</body>
</html>
